<div class="sms-login-form">
  <%= form_for @sms, html: { class: 'ui form' } do |f| %>
    <div class="field <%= 'error' if @sms.errors[:title].any? %>">
      <%= f.label :title %>
      <%= f.text_field :title, placeholder: 'Введите название рассылки' %>
      <%= render 'shared/field_errors', object: @sms, field_name: :title %>
    </div>
    <div class="two fields">
      <div class="field <%= 'error' if @sms.errors[:sender].any? %>">
        <%= f.label :sender_id %>
        <%= f.collection_select :sender_id, Sender.all, :id, :name, { prompt: 'Выберите отправителя' }, {class: 'ui fluid dropdown' } %>
        <%= render 'shared/field_errors', object: @sms, field_name: :sender %>
      </div>
      <div class="field <%= 'error' if @sms.errors[:contact_list].any? %>">
        <%= f.label :contact_list_id %>
        <%= f.collection_select :contact_list_id, ContactList.all, :id, :title, { prompt: 'Выберите контактный лист' }, {class: 'ui fluid dropdown' } %>
        <%= render 'shared/field_errors', object: @sms, field_name: :contact_list %>
      </div>
    </div>
    <div class="field text-area-field <%= 'error' if @sms.errors[:message].any? %>">
      <%= f.label :message %>
      <div class="result" id="result"></div>
      <%= f.text_area :message, placeholder: 'Введите текст сообщения', id: 'text' %>
      <%= render 'shared/field_errors', object: @sms, field_name: :message %>
    </div>
    <div class="margin-left-30">
      <%= f.submit yield(:create), class: 'ui primary button' %>
      <%= f.submit yield(:resend), :name => "resend[#{@sms.id}]", class: 'ui red button' unless @sms.new_record? %>
    </div>
  <% end %>
</div>
<script>
  function wordCount( val ){
    return {
      characters         : val.length
    };
  }

  var textarea = document.getElementById("text");
  var result   = document.getElementById("result");

  textarea.addEventListener("input", function(){
    var v = wordCount( this.value );
    result.innerHTML = (
        'Кол-во' + ' ' + v.characters
    );
  }, false);
</script>